# ğŸš€ PPanel å®Œæ•´éƒ¨ç½²æŒ‡å—

å‰åç«¯åŒè™šæ‹Ÿæœºéƒ¨ç½²æ–¹æ¡ˆ - GCP è™šæ‹Ÿæœº IP: **136.110.11.215**

---

## ğŸ“Š æ¶æ„æ¦‚è§ˆ

```
ç”¨æˆ·æµè§ˆå™¨
    â†“
136.110.11.215:3000 (Admin Web)
136.110.11.215:3001 (User Web)
    â†“
136.110.11.215:8080 (API Server)
    â†“
Docker Network (ppanel-network)
    â†“
MySQL (mysql:3306) + Redis (redis:6379)
```

---

## ğŸ¯ éƒ¨ç½²é¡ºåº

### âš ï¸ é‡è¦ï¼šå¿…é¡»æŒ‰é¡ºåºéƒ¨ç½²

1. **åç«¯ + æ•°æ®åº“** â† å…ˆéƒ¨ç½²
2. **å‰ç«¯** â† åéƒ¨ç½²ï¼ˆä¾èµ–åç«¯ APIï¼‰

---

## ğŸ“¦ ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²åç«¯

### 1.1 è¿æ¥è™šæ‹Ÿæœº

```bash
# SSH è¿æ¥åˆ° GCP è™šæ‹Ÿæœº
gcloud compute ssh your-instance-name
# æˆ–
ssh user@136.110.11.215
```

### 1.2 å…‹éš†åç«¯ä»£ç 

```bash
cd ~
git clone YOUR_BLITZ_ARROW_SERVER_REPO_URL blitz-arrow-server
cd blitz-arrow-server
```

### 1.3 ä¸€é”®éƒ¨ç½²åç«¯

```bash
chmod +x scripts/deploy-from-source.sh
./scripts/deploy-from-source.sh
```

â³ **ç­‰å¾… 3-5 åˆ†é’Ÿ**ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. âœ… ä¸‹è½½ Go ä¾èµ–
2. âœ… ç¼–è¯‘ Go åº”ç”¨
3. âœ… æ„å»º Docker é•œåƒ
4. âœ… å¯åŠ¨ MySQL + Redis + Server å®¹å™¨

### 1.4 åˆå§‹åŒ–åç«¯

è®¿é—®ï¼š**http://136.110.11.215:8080/init**

å¡«å†™é…ç½®ï¼š

| æœåŠ¡  | å­—æ®µ     | å€¼                  |
|-------|----------|---------------------|
| MySQL | ä¸»æœºåœ°å€ | `mysql`             |
|       | ç«¯å£     | `3306`              |
|       | æ•°æ®åº“å | `ppanel`            |
|       | ç”¨æˆ·å   | `ppanel`            |
|       | å¯†ç      | `ppanel_password`   |
| Redis | ä¸»æœºåœ°å€ | `redis`             |
|       | ç«¯å£     | `6379`              |
|       | å¯†ç      | ç•™ç©º                |
| ç®¡ç†å‘˜| é‚®ç®±     | æ‚¨çš„é‚®ç®±            |
|       | å¯†ç      | è®¾ç½®å®‰å…¨å¯†ç         |

ç‚¹å‡»æäº¤å®Œæˆåˆå§‹åŒ–ã€‚

---

## ğŸ¨ ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²å‰ç«¯

### 2.1 å…‹éš†å‰ç«¯ä»£ç 

```bash
cd ~
git clone YOUR_BLITZ_ARROW_REPO_URL blitz-arrow
cd blitz-arrow
```

### 2.2 ä¸€é”®éƒ¨ç½²å‰ç«¯

```bash
chmod +x scripts/deploy-from-source.sh
./scripts/deploy-from-source.sh
```

â³ **ç­‰å¾… 15-20 åˆ†é’Ÿ**ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. âœ… é…ç½®ç¯å¢ƒå˜é‡ï¼ˆAPI åœ°å€ç­‰ï¼‰
2. âœ… å®‰è£… Bunï¼ˆå¦‚æœéœ€è¦ï¼‰
3. âœ… å®‰è£…ä¾èµ–ï¼ˆbun installï¼‰
4. âœ… æ„å»ºåº”ç”¨ï¼ˆTurbo + Next.jsï¼‰
5. âœ… æ„å»º Docker é•œåƒ
6. âœ… å¯åŠ¨ Admin + User å®¹å™¨

---

## ğŸ”¥ ç¬¬ä¸‰æ­¥ï¼šé…ç½®é˜²ç«å¢™

### GCP é˜²ç«å¢™è§„åˆ™

```bash
gcloud compute firewall-rules create allow-ppanel-all \
  --allow tcp:3000,tcp:3001,tcp:8080 \
  --description "Allow PPanel Admin, User, and API" \
  --direction INGRESS \
  --target-tags=ppanel
```

æˆ–åœ¨ [GCP æ§åˆ¶å°](https://console.cloud.google.com/networking/firewalls/list) æ‰‹åŠ¨æ·»åŠ ï¼š
- **åç§°**: `allow-ppanel-all`
- **ç›®æ ‡**: ç½‘ç»œä¸­çš„æ‰€æœ‰å®ä¾‹
- **æ¥æº IPv4 èŒƒå›´**: `0.0.0.0/0`
- **åè®®å’Œç«¯å£**: TCP - `3000,3001,8080`

---

## ğŸŒ ç¬¬å››æ­¥ï¼šè®¿é—®åº”ç”¨

### åº”ç”¨åœ°å€

| åº”ç”¨ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| **Admin ç®¡ç†åå°** | http://136.110.11.215:3000 | ç®¡ç†å‘˜ä½¿ç”¨ |
| **User ç”¨æˆ·å‰ç«¯** | http://136.110.11.215:3001 | æ™®é€šç”¨æˆ·ä½¿ç”¨ |
| **API æ–‡æ¡£** | http://136.110.11.215:8080/swagger | API æ¥å£æ–‡æ¡£ |

### ç™»å½•ä¿¡æ¯

ä½¿ç”¨åˆå§‹åŒ–æ—¶è®¾ç½®çš„ç®¡ç†å‘˜é‚®ç®±å’Œå¯†ç ç™»å½•ã€‚

---

## ğŸ“Š å®¹å™¨ç®¡ç†

### æŸ¥çœ‹æ‰€æœ‰å®¹å™¨

```bash
docker ps
```

åº”è¯¥çœ‹åˆ° 5 ä¸ªå®¹å™¨ï¼š
```
ppanel-mysql    (MySQL 8.0)
ppanel-redis    (Redis 7.0)
ppanel-server   (åç«¯ API)
ppanel-admin    (ç®¡ç†åå°)
ppanel-user     (ç”¨æˆ·å‰ç«¯)
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# åç«¯æ—¥å¿—
docker compose -f /tmp/docker-compose-server.yml logs -f server

# å‰ç«¯æ—¥å¿—
docker compose -f /tmp/docker-compose-local.yml logs -f admin
docker compose -f /tmp/docker-compose-local.yml logs -f user

# æ•°æ®åº“æ—¥å¿—
docker logs ppanel-mysql
docker logs ppanel-redis
```

### é‡å¯æœåŠ¡

```bash
# é‡å¯åç«¯
docker compose -f /tmp/docker-compose-server.yml restart server

# é‡å¯å‰ç«¯
docker compose -f /tmp/docker-compose-local.yml restart admin
docker compose -f /tmp/docker-compose-local.yml restart user
```

### åœæ­¢æœåŠ¡

```bash
# åœæ­¢åç«¯
docker compose -f /tmp/docker-compose-server.yml down

# åœæ­¢å‰ç«¯
docker compose -f /tmp/docker-compose-local.yml down
```

---

## ğŸ”„ æ›´æ–°åº”ç”¨

### æ›´æ–°åç«¯

```bash
cd ~/blitz-arrow-server
git pull
./scripts/deploy-from-source.sh
```

### æ›´æ–°å‰ç«¯

```bash
cd ~/blitz-arrow
git pull
./scripts/deploy-from-source.sh
```

---

## ğŸ”Œ ç½‘ç»œè¿æ¥è¯´æ˜

### Docker ç½‘ç»œæ¶æ„

```
ppanel-network (Docker ç½‘ç»œ)
    â”œâ”€â”€ ppanel-mysql (mysql:3306)
    â”œâ”€â”€ ppanel-redis (redis:6379)
    â”œâ”€â”€ ppanel-server (server:8080)
    â”œâ”€â”€ ppanel-admin (admin:3000)
    â””â”€â”€ ppanel-user (user:3000)
```

### è¿æ¥å…³ç³»

```
1. ç”¨æˆ·æµè§ˆå™¨ â†’ å‰ç«¯å®¹å™¨
   http://136.110.11.215:3000 â†’ ppanel-admin
   http://136.110.11.215:3001 â†’ ppanel-user

2. å‰ç«¯ JS ä»£ç  â†’ åç«¯ API
   http://136.110.11.215:8080 â†’ ppanel-server
   ï¼ˆåœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œï¼‰

3. åç«¯å®¹å™¨ â†’ æ•°æ®åº“å®¹å™¨
   mysql:3306 â†’ ppanel-mysql
   redis:6379 â†’ ppanel-redis
   ï¼ˆåœ¨ Docker ç½‘ç»œå†…éƒ¨ï¼‰
```

### ä¸ºä»€ä¹ˆåç«¯ç”¨æœåŠ¡åï¼Ÿ

```bash
# âœ… æ­£ç¡® - å®¹å™¨å†…ä½¿ç”¨æœåŠ¡å
PPANEL_DB=ppanel:ppanel_password@tcp(mysql:3306)/ppanel

# âŒ é”™è¯¯ - ä¸èƒ½ç”¨ localhost
PPANEL_DB=ppanel:ppanel_password@tcp(localhost:3306)/ppanel
```

å› ä¸ºåœ¨ Docker ç½‘ç»œä¸­ï¼Œå®¹å™¨ä¹‹é—´é€šè¿‡æœåŠ¡åé€šä¿¡ã€‚

### ä¸ºä»€ä¹ˆå‰ç«¯ç”¨å…¬ç½‘ IPï¼Ÿ

```bash
# âœ… æ­£ç¡® - ç”¨æˆ·æµè§ˆå™¨è®¿é—®
NEXT_PUBLIC_API_URL=http://136.110.11.215:8080

# âŒ é”™è¯¯ - æµè§ˆå™¨æ— æ³•è®¿é—®
NEXT_PUBLIC_API_URL=http://server:8080
```

å› ä¸ºå‰ç«¯ API è°ƒç”¨åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œéœ€è¦å…¬ç½‘å¯è®¿é—®çš„åœ°å€ã€‚

---

## ğŸ” å®‰å…¨é…ç½®

### 1. ä¿®æ”¹é»˜è®¤å¯†ç 

**ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹ï¼**

```bash
# ä¿®æ”¹ MySQL å¯†ç 
docker exec -it ppanel-mysql mysql -uroot -pppanel_root_password
ALTER USER 'ppanel'@'%' IDENTIFIED BY 'NEW_STRONG_PASSWORD';
FLUSH PRIVILEGES;
```

### 2. é™åˆ¶é˜²ç«å¢™è®¿é—®

```bash
# åªå…è®¸ç‰¹å®š IP è®¿é—®
gcloud compute firewall-rules update allow-ppanel-all \
  --source-ranges YOUR_IP/32
```

### 3. å¯ç”¨ HTTPS

ä½¿ç”¨ Nginx åå‘ä»£ç† + Let's Encryptï¼š

```bash
sudo apt install nginx certbot python3-certbot-nginx
```

---

## ğŸ“‚ ç›®å½•ç»“æ„

```
~/ (è™šæ‹Ÿæœºå®¶ç›®å½•)
â”œâ”€â”€ blitz-arrow-server/          # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ bin/
â”‚   â”œâ”€â”€ cmd/
â”‚   â”œâ”€â”€ internal/
â”‚   â””â”€â”€ scripts/
â”‚       â””â”€â”€ deploy-from-source.sh
â””â”€â”€ blitz-arrow/                 # å‰ç«¯é¡¹ç›®
    â”œâ”€â”€ apps/
    â”‚   â”œâ”€â”€ admin/
    â”‚   â””â”€â”€ user/
    â””â”€â”€ scripts/
        â”œâ”€â”€ deploy-from-source.sh
        â””â”€â”€ configure-for-vm.sh
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: å‰ç«¯æ— æ³•è¿æ¥åç«¯

**æ£€æŸ¥æ¸…å•**ï¼š
1. åç«¯æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š`docker ps | grep ppanel-server`
2. é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ 8080ï¼šè®¿é—® http://136.110.11.215:8080
3. å‰ç«¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼š`cat apps/admin/.env.local`
4. æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹ç½‘ç»œè¯·æ±‚

### Q2: åç«¯æ— æ³•è¿æ¥æ•°æ®åº“

**æ£€æŸ¥æ¸…å•**ï¼š
1. å®¹å™¨æ˜¯å¦åœ¨åŒä¸€ç½‘ç»œï¼š`docker network inspect ppanel-network`
2. æ•°æ®åº“æ˜¯å¦å¥åº·ï¼š`docker logs ppanel-mysql`
3. é…ç½®æ˜¯å¦ä½¿ç”¨æœåŠ¡åï¼šåº”è¯¥æ˜¯ `mysql` ä¸æ˜¯ `localhost`

### Q3: å®¹å™¨å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
docker logs ppanel-server
docker logs ppanel-admin

# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep -E "3000|3001|8080"

# é‡æ–°éƒ¨ç½²
docker compose down
./scripts/deploy-from-source.sh
```

### Q4: ä¿®æ”¹ IP åœ°å€åå¦‚ä½•æ›´æ–°ï¼Ÿ

```bash
# 1. æ›´æ–°è„šæœ¬ä¸­çš„ IP
vim scripts/configure-for-vm.sh  # ä¿®æ”¹ VM_IP
vim scripts/deploy-from-source.sh  # ä¿®æ”¹ VM_IP

# 2. é‡æ–°é…ç½®å‰ç«¯
cd ~/blitz-arrow
./scripts/configure-for-vm.sh

# 3. é‡æ–°éƒ¨ç½²å‰ç«¯
./scripts/deploy-from-source.sh
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### è™šæ‹Ÿæœºé…ç½®å»ºè®®

| é…ç½® | æœ€ä½ | æ¨è |
|------|------|------|
| CPU | 2 vCPU | 4 vCPU |
| å†…å­˜ | 4GB | 8GB |
| ç£ç›˜ | 20GB | 50GB |

### èµ„æºå ç”¨å‚è€ƒ

```
ppanel-mysql    ~500MB
ppanel-redis    ~50MB
ppanel-server   ~100MB
ppanel-admin    ~100MB
ppanel-user     ~100MB
-------------------
æ€»è®¡            ~850MB
```

---

## ğŸ‰ éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] åç«¯å®¹å™¨è¿è¡Œæ­£å¸¸
- [ ] æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ
- [ ] å‰ç«¯å®¹å™¨è¿è¡Œæ­£å¸¸
- [ ] é˜²ç«å¢™è§„åˆ™å·²é…ç½®
- [ ] å¯ä»¥è®¿é—® Admin: http://136.110.11.215:3000
- [ ] å¯ä»¥è®¿é—® User: http://136.110.11.215:3001
- [ ] å¯ä»¥ç™»å½•ç®¡ç†åå°
- [ ] API è°ƒç”¨æ­£å¸¸

---

ç¥éƒ¨ç½²é¡ºåˆ©ï¼ğŸš€

å¦‚æœ‰é—®é¢˜ï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼š
```bash
docker logs ppanel-server
docker logs ppanel-admin
docker logs ppanel-user
```

